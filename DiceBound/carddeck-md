# ğŸ´ CARD DECK SYSTEM â€” Design & Integration Guide

## ğŸ§­ Overview
Card Deck System lÃ  há»‡ thá»‘ng **power-up chiáº¿n thuáº­t** cho game dice-based hiá»‡n táº¡i.  
NÃ³ cho phÃ©p ngÆ°á»i chÆ¡i **chuáº©n bá»‹ bá»™ ká»¹ nÄƒng (card)** trÆ°á»›c khi vÃ o run Ä‘á»ƒ **can thiá»‡p vÃ o xÃºc xáº¯c, combat vÃ  stat**.  
ÄÃ¢y lÃ  vector phÃ¡t triá»ƒn chÃ­nh cá»§a *outer loop* (meta progression), giÃºp game chuyá»ƒn tá»« â€œluck-onlyâ€ â†’ â€œstrategy + progressionâ€.

---

## ğŸ¯ Design Goals
- TÄƒng **tÃ­nh kiá»ƒm soÃ¡t vÃ  quyáº¿t Ä‘á»‹nh** trong gameplay luck-based.
- Má»Ÿ ra **build diversity** thÃ´ng qua deck-building.
- Táº¡o **retention loop**: má»Ÿ khÃ³a, nÃ¢ng cáº¥p, thá»­ combo má»›i.
- Giá»¯ nguyÃªn pacing nhanh vÃ  cÆ¡ cháº¿ turn-based cÅ©.

---

## ğŸ§© Core Mechanics

### 1. Deck Composition
- NgÆ°á»i chÆ¡i chá»n **4 card active** trÆ°á»›c khi báº¯t Ä‘áº§u má»—i run.
- Má»—i card cÃ³:
  - `cooldown`: sá»‘ turn Ä‘á»ƒ há»“i chiÃªu.
  - `condition`: Ä‘iá»u kiá»‡n kÃ­ch hoáº¡t (onRoll, beforeMove, onCombat).
  - `effect`: function thá»±c thi hÃ nh Ä‘á»™ng.
  - `rarity`: Common / Rare / Epic.
- Trong tráº­n, chá»‰ **card off-cooldown** má»›i cÃ³ thá»ƒ dÃ¹ng.

### 2. In-game Usage (Inner Loop)
- Khi ngÆ°á»i chÆ¡i **roll dice**, UI hiá»ƒn thá»‹ danh sÃ¡ch card sáºµn sÃ ng.
- NgÆ°á»i chÆ¡i cÃ³ thá»ƒ **kÃ­ch hoáº¡t 1 card má»—i turn**.
- Sau khi dÃ¹ng, card â†’ cooldown; há»“i -1 má»—i turn.

### 3. Meta Progression (Outer Loop)
- NgoÃ i tráº­n, ngÆ°á»i chÆ¡i cÃ³:
  - **Card Library**: toÃ n bá»™ card Ä‘Ã£ má»Ÿ khÃ³a.
  - **Deck Builder**: chá»n 4 card cho run káº¿ tiáº¿p.
  - **Currency Loop**:
    - Tháº¯ng tráº­n â†’ nháº­n â€œCard Fragmentâ€.
    - Gom fragment â†’ má»Ÿ khÃ³a card má»›i.
    - DÃ¹ng â€œCard Dustâ€ Ä‘á»ƒ nÃ¢ng cáº¥p card (giáº£m CD, tÄƒng hiá»‡u á»©ng).

---

## âš”ï¸ Example Cards

| Name | Type | Effect | Cooldown | Notes |
|------|------|---------|-----------|-------|
| ğŸ¯ Lucky Eye | Dice | +2 vÃ o dice hiá»‡n táº¡i (max 6) | 3 | Control roll |
| ğŸ” Chaos Flip | Dice | Reroll, nhÆ°ng náº¿u káº¿t quáº£ tháº¥p hÆ¡n thÃ¬ máº¥t 5 value | 2 | Riskâ€“reward |
| ğŸŒ€ Time Anchor | Dice | LÆ°u roll hiá»‡n táº¡i sang turn sau | 4 | Resource management |
| âš”ï¸ Battle Cry | Combat | +50% damage cho combat káº¿ | 4 | Burst finisher |
| ğŸ›¡ï¸ Shield Rune | Combat | Giáº£m 50% damage khi thua combat | 3 | Safety net |
| ğŸ’« Echo Step | Utility | Di chuyá»ƒn thÃªm 1 Ã´ sau khi dá»«ng | 2 | Positioning |
| ğŸ’– Fortune Blessing | Utility | Há»“i 5 value khi roll 6 | Passive | Sustain |

---

## ğŸ§± Data Structure (JS-friendly)
```js
const cards = [
  {
    id: "lucky_eye",
    name: "Lucky Eye",
    type: "dice",
    rarity: "common",
    cooldown: 3,
    condition: "onRoll",
    effect: (state) => {
      state.dice = Math.min(6, state.dice + 2);
      state.log("ğŸ¯ Lucky Eye used! Dice +2");
    },
    description: "Add +2 to your dice after rolling (max 6)."
  },
  ...
];

## ğŸ” Turn Flow Integration
Player Turn
 â”œâ”€â”€ Roll 1D6
 â”œâ”€â”€ Show available cards
 â”œâ”€â”€ Use 1 card (optional)
 â”‚    â””â”€â”€ Apply effect â†’ start cooldown
 â”œâ”€â”€ Choose direction
 â””â”€â”€ Move â†’ Encounter â†’ End Turn
